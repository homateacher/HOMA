<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>í˜¸ë§ˆë§¨ì˜ ì²´ìœ¡íƒêµ¬ â€” ë¬¸ì œí’€ì´ Â· ìš”ì•½ì •ë¦¬ Â· ìŠ¤íŠ¸ë ˆì¹­&íšŒë³µ</title>
<style>
  :root{
    --bg:#f7fafc; --ink:#0f172a; --muted:#64748b; --card:#ffffff; --border:#e5e7eb;
    --accent:#2563eb; --accent-2:#0ea5e9; --ok:#16a34a; --bad:#ef4444; --hint:#0ea5e9;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:Pretendard,"Noto Sans KR",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    background: radial-gradient(900px 600px at 15% -10%, #e0f2fe 0%, var(--bg) 40%) fixed;
    color:var(--ink); line-height:1.65; -webkit-text-size-adjust:100%;
    display:flex; flex-direction:column; align-items:center;
  }
  header{width:100%; max-width:1100px; padding:22px 14px 2px}
  h1{margin:0; font-size:clamp(20px,4.6vw,38px)}
  .sub{margin:4px 0 0; color:#475569; font-size:clamp(12px,3.3vw,14px)}
  .app{width:100%; max-width:1100px; padding:10px 12px 28px}
  .tabs{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
  .tab-btn{border:1px solid var(--border); background:#f8fafc; color:#0f172a; padding:10px 14px; border-radius:999px; cursor:pointer; font-weight:600;}
  .tab-btn.active{ background:linear-gradient(135deg, rgba(37,99,235,.14), rgba(14,165,233,.14)); border-color:#bfdbfe; }
  .panel{ display:none; }
  .panel.active{ display:block; }
  .card{background:var(--card); border:1px solid var(--border); border-radius:18px; padding:14px; margin-top:12px; box-shadow:0 6px 20px rgba(15,23,42,.06)}
  .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  button{cursor:pointer;border:1px solid var(--border);background:#f8fafc;color:#111827;padding:12px 14px;border-radius:12px; font-size:clamp(14px,3.8vw,16px);-webkit-tap-highlight-color:transparent; width:auto;}
  @media (max-width:560px){ .row button{flex:1 1 100%} }
  button.primary{background:linear-gradient(135deg, rgba(37,99,235,.10), rgba(14,165,233,.10))}
  button[disabled]{opacity:.5;cursor:not-allowed}
  .qnum{font-weight:700;color:#334155}
  .prompt{font-size:clamp(16px,4.4vw,20px);margin:6px 0 10px; word-break:keep-all}
  .options{display:grid;gap:8px}
  @media(min-width:720px){.options{grid-template-columns:1fr 1fr}}
  .opt{display:flex;gap:10px;align-items:flex-start;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#f9fafb}
  .opt input{margin-top:4px; transform: scale(1.15)}
  .opt span{word-break:keep-all; overflow-wrap:anywhere}
  .opt.correct{border-color:rgba(22,163,74,.7);box-shadow:0 0 0 2px rgba(22,163,74,.18) inset;background:#ecfdf5}
  .opt.wrong{border-color:rgba(239,68,68,.7);box-shadow:0 0 0 2px rgba(239,68,68,.18) inset;background:#fef2f2}
  .meta{display:flex;justify-content:space-between;align-items:center; gap:8px; flex-wrap:wrap}
  .pill{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--border);font-size:12px;color:#0b5394;background:#e0f2fe}
  .explain{margin-top:10px;padding:10px;border-left:3px solid var(--hint);background:#f0f9ff;border-radius:8px; font-size:clamp(13px,3.6vw,14px)}
  .score{font-size:clamp(28px,7vw,40px);font-weight:800;text-align:center;margin:10px 0;color:#0b5394}
  ul{margin:6px 0 0 18px; padding-left:18px}
  .small{font-size:clamp(12px,3.4vw,13px); color:#6b7280}
  #confettiCanvas{position:fixed; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:9999;}
  .grid{display:grid; gap:12px; grid-template-columns:1fr}
  @media(min-width:820px){ .grid{ grid-template-columns:1fr 1fr } }
  .muscle-card{padding:14px; border:1px solid var(--border); border-radius:16px; background:linear-gradient(180deg,#ffffff, #f8fafc);}
  .muscle-card h3{margin:0 0 4px; font-size:clamp(16px,4.4vw,20px)}
  .tag{display:inline-block; font-size:12px; padding:2px 8px; border-radius:999px; background:#eef2ff; color:#3730a3; border:1px solid #e5e7eb; margin-right:6px}
  .sec{margin-top:8px}
  .sec b{color:#0b5394}
  .list{margin:4px 0 0 18px}
  .guide-grid{display:grid; gap:12px; grid-template-columns:1fr}
  @media(min-width:980px){ .guide-grid{ grid-template-columns:1fr 1fr } }
  .recovery-card{padding:14px; border:1px solid var(--border); border-radius:16px; background:linear-gradient(180deg,#ffffff, #f8fafc);}
  .recovery-card h3{margin:0 0 8px; font-size:clamp(16px,4.4vw,20px)}
  .pill-row{display:flex; gap:6px; flex-wrap:wrap}
  .pill2{display:inline-block; font-size:12px; padding:2px 8px; border-radius:999px; background:#ecfeff; color:#155e75; border:1px solid #e5e7eb}
  .cols{display:grid; gap:10px; grid-template-columns:1fr}
  @media(min-width:720px){ .cols{ grid-template-columns:1fr 1fr } }
  .box{border:1px dashed #dbeafe; background:#f8fbff; border-radius:12px; padding:10px}
  .box b{color:#0b5394}
  .warn{color:#b91c1c; font-weight:600}
</style>
</head>
<body>
<canvas id="confettiCanvas"></canvas>
<header>
  <h1>í˜¸ë§ˆë§¨ì˜ ì²´ìœ¡íƒêµ¬</h1>
  <div class="sub">ë¬¸ì œí’€ì´ Â· ìš”ì•½ì •ë¦¬ Â· ìŠ¤íŠ¸ë ˆì¹­&íšŒë³µ â€” ì„¸ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ë‹¨ë‹¨í•˜ê²Œ! âœ¨</div>
</header>

<div class="app">
  <div class="tabs">
    <button class="tab-btn active" data-tab="quiz">ë¬¸ì œí’€ì´</button>
    <button class="tab-btn" data-tab="study">ìš”ì•½ì •ë¦¬</button>
    <button class="tab-btn" data-tab="recovery">ìŠ¤íŠ¸ë ˆì¹­ & íšŒë³µ</button>
  </div>

  <section id="quiz" class="panel active">
    <div class="card" id="intro">
      <div class="row">
        <button class="primary" id="startBtn">í€´ì¦ˆ ì‹œì‘ (10ë¬¸í•­)</button>
      </div>
      <p class="small">ê·¼ìœ¡ í•˜ë‚˜ê°€ ì œì‹œë˜ë©´ ë³´ê¸° 4~5ê°œ ì¤‘ <b>í•´ë‹¹ ê·¼ìœ¡ì˜ ê´€ì ˆâ€”ë™ì‘</b>ì„ ê³ ë¥´ì„¸ìš”. ì •ë‹µì´ ì—¬ëŸ¬ ê°œì¼ ë•ŒëŠ” <b>í•˜ë‚˜ë§Œ ê³¨ë¼ë„ ì •ë‹µ</b>ìœ¼ë¡œ ì¸ì •í•©ë‹ˆë‹¤.</p>
    </div>

    <div class="card" id="quizCard" style="display:none">
      <div class="meta">
        <div><span class="qnum" id="qIdx">1</span>/10</div>
        <div class="pill" id="typeBadge">ì •ë‹µ ì—¬ëŸ¬ ê°œ(í•˜ë‚˜ë§Œ ê³¨ë¼ë„ ì •ë‹µ)</div>
      </div>
      <div class="prompt" id="prompt">ì—¬ê¸°ì— ë¬¸ì œê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
      <div class="options" id="options"></div>
      <div class="row" style="margin-top:10px">
        <button id="submitBtn" class="primary">ì œì¶œ</button>
        <button id="nextBtn" style="display:none">ë‹¤ìŒ â–¶</button>
        <div class="small" id="feedback"></div>
      </div>
      <div class="explain" id="explain" style="display:none"></div>
    </div>

    <div class="card" id="result" style="display:none">
      <h3 style="margin:0 0 8px">ê²°ê³¼</h3>
      <div class="score" id="score"></div>
      <div id="passMsg" class="small" style="text-align:center; margin-top:6px"></div>
      <div class="row" style="justify-content:center; margin-top:10px">
        <button class="primary" onclick="location.reload()">ìƒˆë¡œ ê³ ì¹¨í•˜ì—¬ ìƒˆ ëœë¤ ì„¸íŠ¸ ì‹œì‘</button>
      </div>
      <div class="explain" id="summary" style="margin-top:12px"></div>
    </div>
  </section>

  <section id="study" class="panel">
    <div class="card">
      <h2 style="margin:4px 0 8px">ê·¼ìœ¡ ìš”ì•½ ì •ë¦¬</h2>
      <p class="small">ìˆ˜ì—…ì—ì„œ ë‹¤ë£¬ ê·¼ìœ¡ë“¤ì— ëŒ€í•´ <b>ìœ„ì¹˜</b>, <b>ëŒ€í‘œ ì—­í• </b>, <b>ì¶”ì²œ ìš´ë™ë²•</b>ì„ í•œëˆˆì— ì •ë¦¬í–ˆì–´ìš”.</p>
      <div class="grid" id="guideGrid"></div>
    </div>
  </section>

  <section id="recovery" class="panel">
    <div class="card">
      <h2 style="margin:4px 0 8px">ìŠ¤íŠ¸ë ˆì¹­ & íšŒë³µ ê°€ì´ë“œ</h2>
      <p class="small">ê° ê·¼ìœ¡ë³„ë¡œ <b>ë§¨ëª¸ ìŠ¤íŠ¸ë ˆì¹­</b>ê³¼ <b>ë„êµ¬ ê¸°ë°˜(í¼ë¡¤ëŸ¬Â·ë§ˆì‚¬ì§€ë³¼)</b>ì„ êµ¬ë¶„í•´ ì •ë¦¬í–ˆì–´ìš”. <span class="warn">í†µì¦ì´ ì‹¬í•˜ë©´ ì¤‘ë‹¨</span>í•˜ê³ , 5~6ë‹¨ê³„ì˜ í¸ì•ˆí•œ ë‹¹ê¹€ ìˆ˜ì¤€ì—ì„œ ì‹œí–‰í•˜ì„¸ìš”.</p>
      <div class="guide-grid" id="recoveryGrid"></div>
    </div>
  </section>
</div>

<script>
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const tab = btn.getAttribute('data-tab');
    document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
    document.getElementById(tab).classList.add('active');
  });
});

const MUSCLES = [
  {name:"ìŠ¹ëª¨ê·¼(ìƒÂ·ì¤‘Â·í•˜ë¶€)", actions:["ê²¬ê°‘ â€” ê±°ìƒ","ê²¬ê°‘ â€” í•˜ê°•","ê²¬ê°‘ â€” í›„ì¸(ë‚´ì „)","ê²¬ê°‘ â€” ìƒë°©íšŒì „","ê²¬ê°‘ â€” ìƒë°©íšŒì „(ìƒÂ·í•˜ë¶€ í˜‘ì‘)"]},
  {name:"ê´‘ë°°ê·¼", actions:["ì–´ê¹¨ â€” ì‹ ì „","ì–´ê¹¨ â€” ë‚´ì „","ì–´ê¹¨ â€” ë‚´íšŒì „","ê²¬ê°‘ â€” í•˜ê°•(ë³´ì¡°)"]},
  {name:"í–„ìŠ¤íŠ¸ë§(ì „ì²´)", actions:["ë¬´ë¦ â€” êµ´ê³¡","ê³ ê´€ì ˆ â€” ì‹ ì „"]},
  {name:"ëŒ€í‡´ì‚¬ë‘ê·¼", actions:["ë¬´ë¦ â€” ì‹ ì „","ê³ ê´€ì ˆ â€” êµ´ê³¡(ëŒ€í‡´ì§ê·¼)"]},
  {name:"ë¹„ë³µê·¼", actions:["ë°œëª© â€” ì €ì¸¡êµ´ê³¡(ë°œë°”ë‹¥êµ½í˜)","ë¬´ë¦ â€” êµ´ê³¡(ë³´ì¡°)"]},
  {name:"ì „ì™„ê·¼(êµ´ê·¼Â·ì‹ ê·¼)", actions:["ì†ëª© â€” êµ´ê³¡","ì†ëª© â€” ì‹ ì „","ì „ì™„ â€” íšŒë‚´(ì¼ë¶€)","ì „ì™„ â€” íšŒì™¸(ì¼ë¶€)","ì†ê°€ë½ â€” êµ´ê³¡/ì‹ ì „(ì¼ë¶€)"]},
  {name:"ìƒì™„ì´ë‘ê·¼", actions:["íŒ”ê¿ˆì¹˜ â€” êµ´ê³¡","ì „ì™„ â€” íšŒì™¸","ì–´ê¹¨ â€” êµ´ê³¡(ë³´ì¡°)"]},
  {name:"ìƒì™„ì‚¼ë‘ê·¼", actions:["íŒ”ê¿ˆì¹˜ â€” ì‹ ì „","ì–´ê¹¨ â€” ì‹ ì „(ì¥ë‘)","ì–´ê¹¨ â€” ë‚´ì „(ì¥ë‘)"]},
  {name:"ì‚¼ê°ê·¼(ì „Â·ì¤‘Â·í›„ë¶€)", actions:["ì–´ê¹¨ â€” êµ´ê³¡(ì „ë¶€)","ì–´ê¹¨ â€” ì™¸ì „(ì¤‘ë¶€)","ì–´ê¹¨ â€” ì‹ ì „(í›„ë¶€)","ì–´ê¹¨ â€” ë‚´íšŒì „(ì „ë¶€)","ì–´ê¹¨ â€” ì™¸íšŒì „(í›„ë¶€)","ì–´ê¹¨ â€” ìˆ˜í‰ë‚´ì „(ì „ë¶€)","ì–´ê¹¨ â€” ìˆ˜í‰ì™¸ì „(í›„ë¶€)"]},
  {name:"ë³µê·¼(ë³µì§ê·¼ ì¤‘ì‹¬)", actions:["ëª¸í†µ â€” êµ´ê³¡","ê³¨ë°˜ â€” í›„ë°©ê²½ì‚¬"]},
  {name:"ëŒ€ë‘”ê·¼", actions:["ê³ ê´€ì ˆ â€” ì‹ ì „","ê³ ê´€ì ˆ â€” ì™¸íšŒì „","ê³ ê´€ì ˆ â€” ë²Œë¦¼(ìƒë¶€ì„¬ìœ )"]},
  {name:"ì¤‘ë‘”ê·¼", actions:["ê³ ê´€ì ˆ â€” ë²Œë¦¼","ê³ ê´€ì ˆ â€” ë‚´íšŒì „(ì „ì„¬ìœ )","ê³ ê´€ì ˆ â€” ì‹ ì „Â·ì™¸íšŒì „(í›„ì„¬ìœ )","ë³´í–‰ ì‹œ ê³¨ë°˜ ì•ˆì •í™”"]},
  {name:"ì¥ìš”ê·¼", actions:["ê³ ê´€ì ˆ â€” êµ´ê³¡","ê³ ê´€ì ˆ â€” ì™¸íšŒì „(ë³´ì¡°)","ìš”ì¶” â€” ì „ë§Œ ìœ ì§€(ë³´ì¡°)"]},
  {name:"ì „ê±°ê·¼", actions:["ê²¬ê°‘ â€” ì „ì¸(ë²Œë¦¼)","ê²¬ê°‘ â€” ìƒë°©íšŒì „","ê²¬ê°‘ â€” ê³ ì •"]},
  {name:"íšŒì „ê·¼ê°œ(ê·¹ìƒ/ê·¹í•˜/ì†Œì›/ê²¬ê°‘í•˜)", actions:["ì–´ê¹¨ â€” ì™¸ì „(ì´ˆê¸°, ê·¹ìƒê·¼)","ì–´ê¹¨ â€” ì™¸íšŒì „(ê·¹í•˜/ì†Œì›ê·¼)","ì–´ê¹¨ â€” ë‚´íšŒì „(ê²¬ê°‘í•˜ê·¼)","ê²¬ê´€ì ˆ ì•ˆì •í™”"]},
  {name:"ë‚´ì „ê·¼êµ°(ì¥/ë‹¨/ëŒ€ë‚´ì „ê·¼ ë“±)", actions:["ê³ ê´€ì ˆ â€” ë‚´ì „","ê³ ê´€ì ˆ â€” êµ´ê³¡(ë³´ì¡°)","ê³ ê´€ì ˆ â€” ì™¸íšŒì „(ì¼ë¶€)"]},
];
const EXTRA_ACTIONS = [
  "ì–´ê¹¨ â€” ê´€ì ˆ ì¤‘ì‹¬ ì•ˆì •í™”(ë³´ì¡°)","ê²¬ê°‘ â€” í•˜ë°©íšŒì „(ë³´ì¡°)","ëª¸í†µ â€” ì‹ ì „(ë³´ì¡°)","ë¬´ë¦ â€” ì‹ ì „(ë³´ì¡°)",
  "ë°œëª© â€” ë°°ì¸¡êµ´ê³¡(ë³´ì¡°)","ì „ì™„ â€” ì¤‘ë¦½ ìœ ì§€(ë³´ì¡°)","ê³¨ë°˜ â€” ì „ë°©ê²½ì‚¬(ë³´ì¡°)","ê²¬ê°‘ â€” ì „ì¸/í›„ì¸ ì¡°ì ˆ(ë³´ì¡°)"
];
const ALL_ACTIONS = Array.from(new Set([ ...MUSCLES.flatMap(m=>m.actions), ...EXTRA_ACTIONS ]));

const CONCEPT_QUESTIONS = [{
  type: "concept",
  prompt: "ê±°ë¶ëª©(Forward head posture) ì˜ˆë°©Â·êµì •ì— í•µì‹¬ì ìœ¼ë¡œ ë„ì›€ì´ ë˜ëŠ” ìŠ¹ëª¨ê·¼ì˜ ë¶€ë¶„ì€?",
  options: ["ìƒë¶€ìŠ¹ëª¨ê·¼","ì¤‘ë¶€ìŠ¹ëª¨ê·¼","í•˜ë¶€ìŠ¹ëª¨ê·¼"],
  truth: new Set(["í•˜ë¶€ìŠ¹ëª¨ê·¼"]),
  explain: "<b>ì •ë‹µ: í•˜ë¶€ìŠ¹ëª¨ê·¼</b><br>í•˜ë¶€ìŠ¹ëª¨ê·¼ì€ ê²¬ê°‘ê³¨ <b>í•˜ê°•Â·í›„ë°©ê²½ì‚¬</b>ì— ê¸°ì—¬í•˜ì—¬ ìƒë¶€ìŠ¹ëª¨ê·¼ ê³¼í™œì„±Â·ê²¬ê°‘ ê±°ìƒÂ·ì „ì¸ íŒ¨í„´ì„ ì–µì œí•˜ê³ , ì „ê±°ê·¼/ì¤‘ë¶€ìŠ¹ëª¨ê·¼ê³¼ í•¨ê»˜ ë¼ìš´ë“œìˆ„ë”Â·ê±°ë¶ëª© íŒ¨í„´ì„ êµì •í•˜ëŠ” ë° í•µì‹¬ì ìœ¼ë¡œ ì“°ì…ë‹ˆë‹¤."
}];

let state = { total: 10, bank: [], idx: 0, correct: 0 };
function zeroWidthTrim(s){ return s.replace(/[â€‹-â€ï»¿]/g,'').replace(/Â /g,' '); }
function stripParen(s){ return s.replace(/\([^)]*\)/g,''); }
function normAction(str){
  let s = zeroWidthTrim(String(str)).replace(/[â€“â€”-]/g,'â€”').replace(/[ï¼ˆ]/g,'(').replace(/[ï¼‰]/g,')');
  let parts = s.split('â€”').map(t=>t.trim());
  if(parts.length>=2){
    let joint = stripParen(parts[0]).trim().toLowerCase();
    let move  = stripParen(parts[1]).trim().toLowerCase();
    return joint + 'â€”' + move;
  }
  return stripParen(s).trim().toLowerCase();
}
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]] } return arr; }
function sample(arr,k){ const c=arr.slice(); shuffle(c); return c.slice(0,Math.min(k,c.length)); }
function uniq(arr){ const seen=new Set(); const out=[]; for(const x of arr){ const k=normAction(x); if(!seen.has(k)){ seen.add(k); out.push(x);} } return out; }

document.getElementById('startBtn').addEventListener('click', startQuiz);
function startQuiz(){
  state.bank = buildQuestions(state.total);
  state.idx = 0; state.correct = 0;
  document.getElementById('intro').style.display='none';
  document.getElementById('quizCard').style.display='block';
  render();
}
function buildQuestions(n){
  const regular = buildRegularQuestions(Math.max(0, n-1));
  const concept = sample(CONCEPT_QUESTIONS, 1);
  const pos = Math.floor(Math.random()* (regular.length+1));
  return regular.slice(0,pos).concat(concept, regular.slice(pos));
}
function buildRegularQuestions(n){
  const ms = shuffle(MUSCLES.slice()).slice(0, Math.min(n, MUSCLES.length));
  return ms.map(m => makeMuscleQuestion(m));
}
function makeMuscleQuestion(m){
  const truthNorm = new Set(m.actions.map(normAction));
  const acts = m.actions.slice();
  const k = Math.min(3, Math.max(1, Math.floor(Math.random()*3)+1));
  const showCorrectArr = sample(acts, Math.min(k, acts.length));
  const optionCount = (Math.random()<0.5 ? 4 : 5);

  let options = showCorrectArr.slice();
  const pool = ALL_ACTIONS.filter(a => !m.actions.includes(a));
  const jointKey = acts[0].split('â€”')[0].trim();
  const sameJoint = pool.filter(a => a.startsWith(jointKey));
  const otherJoint = pool.filter(a => !a.startsWith(jointKey));
  let distractors = uniq([ ...sample(sameJoint, optionCount * 2), ...sample(otherJoint, optionCount * 2) ]);

  for(const d of distractors){
    if(options.length >= optionCount) break;
    if(!options.map(normAction).includes(normAction(d))) options.push(d);
  }
  let idx=0;
  while(options.length < optionCount && idx < pool.length){
    const cand = pool[idx++];
    if(!options.map(normAction).includes(normAction(cand))) options.push(cand);
  }
  options = uniq(options);
  if(!options.some(o=>truthNorm.has(normAction(o)))) options.push(acts[0]);
  options = shuffle(options);

  const explain = `<b>${m.name}</b>ì˜ ëŒ€í‘œ ì‘ìš©<br>â€¢ ${m.actions.join("<br>â€¢ ")}`;
  return { type:"regular", muscle:m.name, options, truthNorm, explain };
}

function render(){
  const q = state.bank[state.idx];
  document.getElementById('qIdx').textContent = state.idx+1;
  const prompt = document.getElementById('prompt');
  const optWrap = document.getElementById('options'); optWrap.innerHTML='';

  if(q.type==="concept"){
    document.getElementById('typeBadge').textContent = "ê°œë… ë¬¸ì œ";
    prompt.innerHTML = q.prompt;
    q.options.forEach(txt=>{
      const div = document.createElement('label'); div.className='opt';
      const inp = document.createElement('input'); inp.type='checkbox'; inp.name='opt'; inp.value=txt;
      inp.addEventListener('change', ()=>{ document.querySelectorAll('input[name="opt"]').forEach(el=>{ if(el!==inp) el.checked=false; }); });
      const span = document.createElement('span'); span.textContent = txt;
      div.appendChild(inp); div.appendChild(span); optWrap.appendChild(div);
    });
  } else {
    document.getElementById('typeBadge').textContent = "ì •ë‹µ ì—¬ëŸ¬ ê°œ(í•˜ë‚˜ë§Œ ê³¨ë¼ë„ ì •ë‹µ)";
    prompt.innerHTML = `ê·¼ìœ¡: <b>${q.muscle}</b><br><span class="small">í•´ë‹¹ ê·¼ìœ¡ì´ ë‹´ë‹¹í•˜ëŠ” <b>ê´€ì ˆ â€” ë™ì‘</b>ì„ í•˜ë‚˜ ì´ìƒ ê³ ë¥´ì„¸ìš”.</span>`;
    q.options.forEach((txt)=>{
      const div = document.createElement('label'); div.className='opt';
      const inp = document.createElement('input'); inp.type='checkbox'; inp.name='opt'; inp.value=txt;
      const span = document.createElement('span'); span.textContent = txt;
      div.appendChild(inp); div.appendChild(span); optWrap.appendChild(div);
    });
  }

  document.getElementById('feedback').textContent='';
  document.getElementById('explain').style.display='none';
  document.getElementById('submitBtn').style.display='inline-flex';
  document.getElementById('nextBtn').style.display='none';
}

document.getElementById('submitBtn').addEventListener('click', ()=>{
  const q = state.bank[state.idx];
  const chosen = Array.from(document.querySelectorAll('input[name="opt"]:checked')).map(x=>x.value);
  if(chosen.length===0){ alert('í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
  const chosenNorm = new Set(chosen.map(normAction));

  let isCorrect = false;
  if(q.type==="concept"){
    const truthNorm = new Set([...q.truth].map(x=>String(x).trim().toLowerCase()));
    isCorrect = (chosenNorm.size===1) && truthNorm.has([...chosenNorm][0]);
  } else {
    const truthNorm = q.truthNorm;
    isCorrect = [...chosenNorm].some(x=>truthNorm.has(x));
  }
  if(isCorrect) state.correct++;

  document.querySelectorAll('.opt').forEach(div=>{
    const val = normAction(div.querySelector('input').value);
    let isTrue;
    if(q.type==="concept"){
      const truthNorm = new Set([...q.truth].map(x=>String(x).trim().toLowerCase()));
      isTrue = truthNorm.has(val);
    } else {
      isTrue = q.truthNorm.has(val);
    }
    const picked = chosenNorm.has(val);
    if(isTrue) div.classList.add('correct');
    if(picked && !isTrue) div.classList.add('wrong');
    div.querySelector('input').disabled = true;
  });

  document.getElementById('feedback').textContent = isCorrect ? "ì •ë‹µ! ì˜í–ˆì–´ìš” ğŸ‘" : "ì˜¤ë‹µ ğŸ˜… ì •ë‹µ í‘œì‹œë¥¼ í™•ì¸í•˜ì„¸ìš”.";
  const ex = document.getElementById('explain'); ex.innerHTML = q.explain; ex.style.display='block';
  document.getElementById('submitBtn').style.display='none';
  document.getElementById('nextBtn').style.display='inline-flex';

  if(isCorrect){ fireDing(); triggerConfetti(1); } else { buzz(); }
});

document.getElementById('nextBtn').addEventListener('click', ()=>{
  state.idx++;
  if(state.idx >= state.total){ showResult(); }
  else { render(); }
});

function showResult(){
  document.getElementById('quizCard').style.display='none';
  document.getElementById('result').style.display='block';
  const points = state.correct * 10;
  const pct = Math.round(100*state.correct/state.total);
  document.getElementById('score').textContent = `ì •ë‹µ ${state.correct} / ${state.total} â†’ ${points}ì  (${pct}%)`;

  const msgEl = document.getElementById('passMsg');
  if(points === 100){
    msgEl.innerHTML = "<b>ğŸ† ë‹¹ì‹ ì€ ê·¼ìœ¡ ë§ˆìŠ¤í„°!!!! ğŸ†</b><br>í™˜ìƒì ì¸ ì§‘ì¤‘ë ¥ê³¼ ê¸°ì–µë ¥ìœ¼ë¡œ ì™„ë²½ ì •ë³µ! ğŸ’ªğŸ‰ğŸ”¥";
  } else if(points >= 90){
    msgEl.innerHTML = "ğŸŒŸ ê±°ì˜ ì™„ë²½! ê·¼ìœ¡ ë°•ì‚¬ ê·¼ì²˜ê¹Œì§€ ì™”ì–´ìš”! ì¡°ê¸ˆë§Œ ë” ê°€ë©´ ë§ˆìŠ¤í„°! ğŸ‘ğŸ‘";
  } else if(points >= 70){
    msgEl.innerHTML = "ğŸ¯ ì¢‹ì•„ìš”! ê¸°ë³¸ê¸°ë¥¼ í™•ì‹¤íˆ ë‹¤ì¡Œì–´ìš”. ì˜ì§„ìŒ¤ê»˜ ìë‘ìŠ¤ëŸ½ê²Œ ë³´ì—¬ì£¼ì„¸ìš”! ğŸ’™";
  } else if(points >= 61){
    msgEl.innerHTML = "âš¡ í•œ ê±¸ìŒë§Œ ë”! ê³§ 70ì  ëŒíŒŒ! ë‹¤ì‹œ ë„ì „í•´ë³¼ê¹Œìš”? ğŸ”¥";
  } else {
    msgEl.innerHTML = "ğŸ’¥ ì•„ì§ ê·¼ìœ¡ì´ ê¹¨ì–´ë‚˜ì§€ ì•Šì•˜ì–´ìš”! ë‹¤ì‹œ í’€ì–´ì„œ <b>70ì  ì´ìƒ</b> ë§ì„ ë•Œê¹Œì§€ ë„ì „! í™”ì´íŒ…!! ğŸ’ªğŸ”¥";
  }

  fanfare(points);
  const items = state.bank.map((q,i)=>{
    const label = q.type==="concept" ? "(ê°œë…)" : "";
    const truthList = (q.type==="concept") ? [...q.truth].join(", ") : [...q.truthNorm].join(", ");
    const stem = (q.type==="concept") ? q.prompt : q.muscle;
    return `<li><b>${i+1}. ${stem}</b> ${label} â€” ì •ë‹µ: ${truthList}</li>`;
  }).join("");
  document.getElementById('summary').innerHTML = `<b>ì •ë‹µ í•´ì„¤</b><ul>${items}</ul>`;
}

// audio + confetti
let audioCtx;
function ensureAudio(){ if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)(); if(audioCtx.state==='suspended') audioCtx.resume(); return audioCtx;}
function tone(f=880,d=0.2,t='triangle',v=0.2,delay=0){ const c=ensureAudio(); const start=c.currentTime+delay; const o=c.createOscillator(); const g=c.createGain(); o.type=t; o.frequency.setValueAtTime(f,start); g.gain.setValueAtTime(0.0001,start); g.gain.exponentialRampToValueAtTime(v,start+0.02); g.gain.exponentialRampToValueAtTime(0.0001,start+d); o.connect(g).connect(c.destination); o.start(start); o.stop(start+d+0.05); }
function fireDing(){ tone(1046,0.15,'triangle',0.15,0); tone(1318,0.15,'triangle',0.12,0.12); tone(1568,0.2,'triangle',0.10,0.22); }
function buzz(){ const c=ensureAudio(); const t0=c.currentTime; const o=c.createOscillator(); const g=c.createGain(); o.type='sawtooth'; o.frequency.setValueAtTime(180,t0); g.gain.setValueAtTime(0.001,t0); g.gain.exponentialRampToValueAtTime(0.18,t0+0.05); g.gain.exponentialRampToValueAtTime(0.0001,t0+0.35); o.connect(g).connect(c.destination); o.start(t0); o.stop(t0+0.4); }
function fanfare(score){ const c=ensureAudio(); const t0=c.currentTime;
  const buffer=c.createBuffer(1,2*c.sampleRate,c.sampleRate); const data=buffer.getChannelData(0);
  for(let i=0;i<data.length;i++){ data[i]=(Math.random()*2-1)*(1-i/data.length); }
  const noise=c.createBufferSource(); noise.buffer=buffer; const bp=c.createBiquadFilter(); bp.type='bandpass'; bp.frequency.value=1500; bp.Q.value=0.7; const g=c.createGain(); g.gain.setValueAtTime(0.0001,t0); g.gain.exponentialRampToValueAtTime(0.2,t0+0.2); g.gain.exponentialRampToValueAtTime(0.0001,t0+1.0); noise.connect(bp).connect(g).connect(c.destination); noise.start(t0); noise.stop(t0+1.05);
  const base=score===100?523:440; tone(base,0.7,'sine',0.2,0.9); tone(base*5/4,0.7,'sine',0.2,0.92); tone(base*3/2,0.7,'sine',0.2,0.94); tone(base*2,0.6,'sine',0.15,1.0); tone(base*2*5/4,0.6,'sine',0.15,1.02); tone(base*2*3/2,0.6,'sine',0.15,1.04);
}
const confettiCanvas=document.getElementById('confettiCanvas'); const ctx=confettiCanvas.getContext('2d');
function resizeCanvas(){ confettiCanvas.width=window.innerWidth; confettiCanvas.height=window.innerHeight; } window.addEventListener('resize', resizeCanvas); resizeCanvas();
let confettiParticles=[];
function createConfetti(x,y,count=80){ for(let i=0;i<count;i++){ confettiParticles.push({x,y,vx:(Math.random()-0.5)*9,vy:(Math.random()-1.5)*9,size:Math.random()*6+4,color:`hsl(${Math.floor(Math.random()*360)},80%,60%)`,life:110+Math.random()*50}); } }
function updateConfetti(){ ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); let alive=[]; for(const p of confettiParticles){ p.x+=p.vx; p.y+=p.vy; p.vy+=0.22; p.life-=1; ctx.fillStyle=p.color; ctx.fillRect(p.x,p.y,p.size,p.size*0.6); if(p.life>0 && p.y<confettiCanvas.height+60) alive.push(p);} confettiParticles=alive; if(confettiParticles.length>0) requestAnimationFrame(updateConfetti); }
function triggerConfetti(mult=1){ const bursts=Math.max(1,Math.floor(3*mult)); for(let b=0;b<bursts;b++){ const x=window.innerWidth/2+(Math.random()-0.5)*250; const y=window.innerHeight/3+(Math.random()-0.5)*100; createConfetti(x,y,Math.floor(80*mult)); } updateConfetti(); }

const GUIDE = [
  { name:"ìŠ¹ëª¨ê·¼(ìƒÂ·ì¤‘Â·í•˜ë¶€)", tags:["ê²¬ê°‘ê±°ìƒ/í•˜ê°•","í›„ì¸","ìƒë°©íšŒì „"],
    where:"í›„ë‘ê³¨Â·ê²½ì¶”~í‰ì¶”ì—ì„œ ì‹œì‘í•˜ì—¬ ê²¬ê°‘ê·¹Â·ì‡„ê³¨ ì™¸ì¸¡ì— ë¶€ì°©. ë“± ìœ„ìª½ í° ì—­ì‚¼ê°í˜• í˜•íƒœ.",
    roles:["ìƒë¶€: ê²¬ê°‘ ê±°ìƒÂ·ìƒë°©íšŒì „","ì¤‘ë¶€: ê²¬ê°‘ í›„ì¸(ë‚´ì „)","í•˜ë¶€: ê²¬ê°‘ í•˜ê°•Â·ìƒë°©íšŒì „"],
    workouts:["í˜ì´ìŠ¤í’€/ë°´ë“œ ë¦¬íŠ¸ë™ì…˜(ì¤‘ë¶€)","Y-ë ˆì´ì¦ˆÂ·ë«í’€ë‹¤ìš´ì—ì„œ í•˜ë¶€ í™œì„±","ìŠˆëŸ¬ê·¸(ìƒë¶€) ê³¼ë‹¤ ì‚¬ìš© ì£¼ì˜"] },
  { name:"ê´‘ë°°ê·¼", tags:["ì–´ê¹¨ ì‹ ì „","ë‚´ì „","ë‚´íšŒì „"],
    where:"í‰ìš”ê·¼ë§‰Â·í•˜í‰ì¶”Â·ì¥ê³¨ëŠ¥ì—ì„œ ì‹œì‘í•´ ìƒì™„ê³¨ ê²°ì ˆê°„êµ¬ì— ë¶€ì°©. ë“± í•˜ë¶€ë¥¼ ë„“ê²Œ ë®ìŒ.",
    roles:["ì–´ê¹¨ ì‹ ì „/ë‚´ì „/ë‚´íšŒì „","ê²¬ê°‘ í•˜ê°• ë³´ì¡°"],
    workouts:["ë«í’€ë‹¤ìš´/í’€ì—…","ë¡œìš°(ê²¬ê°‘ í•˜ê°•+í‰ì¶” ì‹ ì „)","ìŠ¤íŠ¸ë ˆì´íŠ¸ì•” í’€ë‹¤ìš´"] },
  { name:"í–„ìŠ¤íŠ¸ë§", tags:["ë¬´ë¦ êµ´ê³¡","ê³ ê´€ì ˆ ì‹ ì „"],
    where:"ì¢Œê³¨ê²°ì ˆ(ëŒ€í‡´ì´ë‘ ë‹¨ë‘ ì œì™¸)â†’ê²½ê³¨/ë¹„ê³¨ í›„ì¸¡.",
    roles:["ë¬´ë¦ êµ´ê³¡","ê³ ê´€ì ˆ ì‹ ì „"],
    workouts:["í™íŒì§€ ë°ë“œë¦¬í”„íŠ¸","ë ˆê·¸ì»¬","ë…¸ë¥´ë”• í–„ì»¬"] },
  { name:"ëŒ€í‡´ì‚¬ë‘ê·¼", tags:["ë¬´ë¦ ì‹ ì „","ëŒ€í‡´ì§ê·¼: ê³ ê´€ì ˆ êµ´ê³¡"],
    where:"ëŒ€í‡´ê³¨ ì „ë©´ê³¼ ì¥ê³¨â†’ìŠ¬ê°œê³¨â€”ê²½ê³¨ ê²°ì ˆ.",
    roles:["ë¬´ë¦ ì‹ ì „(ì „ì²´)","ê³ ê´€ì ˆ êµ´ê³¡(ëŒ€í‡´ì§ê·¼)"],
    workouts:["ìŠ¤ì¿¼íŠ¸/ë ˆê·¸í”„ë ˆìŠ¤","ëŸ°ì§€","ë ˆê·¸ìµìŠ¤í…ì…˜"] },
  { name:"ë¹„ë³µê·¼", tags:["ë°œëª© ì €ì¸¡êµ´ê³¡","ë¬´ë¦ êµ´ê³¡ ë³´ì¡°"],
    where:"ëŒ€í‡´ê³¼ ìƒë¶€â†’ì•„í‚¬ë ˆìŠ¤ê±´â†’ì¢…ê³¨.",
    roles:["ë°œëª© ì €ì¸¡êµ´ê³¡(ë°œë°”ë‹¥êµ½í˜)","ë¬´ë¦ êµ´ê³¡ ë³´ì¡°"],
    workouts:["ì¹´í”„ ë ˆì´ì¦ˆ(ì„œì„œ)","ë°•ìŠ¤ ì í”„ ì°©ì§€ ì •ë ¬ ì¸ì‹"] },
  { name:"ì „ì™„ê·¼(êµ´ê·¼Â·ì‹ ê·¼)", tags:["ì†ëª© êµ´/ì‹ ì „","íšŒë‚´/íšŒì™¸ ì¼ë¶€"],
    where:"ìƒì™„ê³¨ ë‚´Â·ì™¸ìƒê³¼â†’ì†ëª©/ì†ê°€ë½ ê±´.",
    roles:["ì†ëª© êµ´ê³¡/ì‹ ì „","ì „ì™„ íšŒë‚´/íšŒì™¸(ì¼ë¶€)","ì†ê°€ë½ êµ´/ì‹ ì „(ì¼ë¶€)"],
    workouts:["ë¦¬ìŠ¤íŠ¸ ì»¬/ë¦¬ë²„ìŠ¤ ë¦¬ìŠ¤íŠ¸ ì»¬","í•´ë¨¸ ì»¬","ê·¸ë¦½ íŠ¸ë ˆì´ë„ˆ"] },
  { name:"ìƒì™„ì´ë‘ê·¼", tags:["íŒ”ê¿ˆì¹˜ êµ´ê³¡","íšŒì™¸"],
    where:"ê²¬ê°‘ê³¨(ìƒÂ·í•˜ê²°ì ˆ)â†’ìš”ê³¨ì¡°ë©´.",
    roles:["íŒ”ê¿ˆì¹˜ êµ´ê³¡","ì „ì™„ íšŒì™¸","ì–´ê¹¨ êµ´ê³¡ ë³´ì¡°"],
    workouts:["ë°”ë²¨/ë¤ë²¨ ì»¬","ì¹œì—…(íšŒì™¸ ê·¸ë¦½)","ì¼€ì´ë¸” ì»¬"] },
  { name:"ìƒì™„ì‚¼ë‘ê·¼", tags:["íŒ”ê¿ˆì¹˜ ì‹ ì „"],
    where:"ê²¬ê°‘ê³¨ ì¥ë‘Â·ìƒì™„ê³¨ ì™¸/ë‚´ì¸¡ë‘â†’ì²™ê³¨.",
    roles:["íŒ”ê¿ˆì¹˜ ì‹ ì „","ì–´ê¹¨ ì‹ ì „Â·ë‚´ì „(ì¥ë‘)"],
    workouts:["í‘¸ì‹œë‹¤ìš´","ìŠ¤ì»¬í¬ëŸ¬ì…”","ë”¥ìŠ¤"] },
  { name:"ì‚¼ê°ê·¼(ì „Â·ì¤‘Â·í›„ë¶€)", tags:["ì–´ê¹¨ êµ´/ì™¸ì „/ì‹ ì „"],
    where:"ì‡„ê³¨ ì™¸ì¸¡Â·ê²¬ë´‰Â·ê²¬ê°‘ê·¹â†’ì‚¼ê°ê·¼ê±°ì¹œë©´.",
    roles:["ì „ë¶€: êµ´ê³¡Â·ë‚´íšŒì „Â·ìˆ˜í‰ë‚´ì „","ì¤‘ë¶€: ì™¸ì „","í›„ë¶€: ì‹ ì „Â·ì™¸íšŒì „Â·ìˆ˜í‰ì™¸ì „"],
    workouts:["ì˜¤ë²„í—¤ë“œ í”„ë ˆìŠ¤","ë«ëŸ´ ë ˆì´ì¦ˆ","ë¦¬ë²„ìŠ¤ í”Œë¼ì´"] },
  { name:"ë³µê·¼(ë³µì§ê·¼ ì¤‘ì‹¬)", tags:["ëª¸í†µ êµ´ê³¡","ê³¨ë°˜ í›„ë°©ê²½ì‚¬"],
    where:"ì¹˜ê³¨â†’ê²€ìƒëŒê¸°Â·ëŠ‘ì—°ê³¨(ì‹ìŠ¤íŒ©).",
    roles:["ëª¸í†µ êµ´ê³¡","ê³¨ë°˜ í›„ë°©ê²½ì‚¬"],
    workouts:["í¬ëŸ°ì¹˜/ë°”ë””ì—…","ë°ë“œë²„ê·¸","í”Œë­í¬"] },
  { name:"ëŒ€ë‘”ê·¼", tags:["ê³ ê´€ì ˆ ì‹ ì „","ì™¸íšŒì „"],
    where:"ì¥ê³¨Â·ì²œê³¨â†’ëŒ€í‡´ê³¨Â·ì¥ê²½ì¸ëŒ€.",
    roles:["ê³ ê´€ì ˆ ì‹ ì „","ì™¸íšŒì „","ìƒë¶€ì„¬ìœ  ë²Œë¦¼"],
    workouts:["í™ì“°ëŸ¬ìŠ¤íŠ¸","ë£¨ë§ˆë‹ˆì•ˆ ë°ë“œë¦¬í”„íŠ¸","ìŠ¤í…ì—…"] },
  { name:"ì¤‘ë‘”ê·¼", tags:["ê³ ê´€ì ˆ ë²Œë¦¼","ë³´í–‰ ì•ˆì •"],
    where:"ì¥ê³¨ ì™¸ì¸¡ë©´â†’ëŒ€í‡´ê³¨ ëŒ€ì „ì.",
    roles:["ë²Œë¦¼","ì „ì„¬ìœ  ë‚´íšŒì „","í›„ì„¬ìœ  ì‹ ì „Â·ì™¸íšŒì „","ë³´í–‰ ì‹œ ê³¨ë°˜ ì•ˆì •í™”"],
    workouts:["ì‚¬ì´ë“œ-ë¼ì‰ ì–´ë¸Œë•ì…˜","ëª¬ìŠ¤í„° ì›Œí¬/í´ë¨ì‰˜","ì‹±ê¸€ë ˆê·¸ RDL"] },
  { name:"ì¥ìš”ê·¼", tags:["ê³ ê´€ì ˆ êµ´ê³¡"],
    where:"ìš”ì¶”ì²´Â·íš¡ëŒê¸°/ì¥ê³¨â†’ì†Œì „ì.",
    roles:["ê³ ê´€ì ˆ êµ´ê³¡","ì™¸íšŒì „(ë³´ì¡°)","ìš”ì¶” ì „ë§Œ ìœ ì§€ ë³´ì¡°"],
    workouts:["í–‰ì‰ ë ˆê·¸ë ˆì´ì¦ˆ","ë§ˆì¹˜ ë“œë¦´","ë”¥ í™ í”Œë ‰ì„œ ìŠ¤íŠ¸ë ˆì¹˜ ë³‘í–‰"] },
  { name:"ì „ê±°ê·¼", tags:["ê²¬ê°‘ ì „ì¸","ìƒë°©íšŒì „"],
    where:"ëŠ‘ê³¨ 1~8â†’ê²¬ê°‘ê³¨ ì•ˆìª½ëª¨ì„œë¦¬.",
    roles:["ê²¬ê°‘ ì „ì¸(ë²Œë¦¼)","ìƒë°©íšŒì „","ê²¬ê°‘ ê³ ì •(ìœ™ì‰ ë°©ì§€)"],
    workouts:["ì›”ìŠ¬ë¼ì´ë“œ+ë¦¬ì¹˜","í‘¸ì‹œì—… í”ŒëŸ¬ìŠ¤","ë°´ë“œ í€ì¹˜ì•„ì›ƒ"] },
  { name:"íšŒì „ê·¼ê°œ(ê·¹ìƒ/ê·¹í•˜/ì†Œì›/ê²¬ê°‘í•˜)", tags:["ì–´ê¹¨ ì•ˆì •í™”"],
    where:"ê²¬ê°‘ê³¨ íšŒì „ê·¼ì™€ ì£¼ë³€â†’ìƒì™„ê³¨ ë‘.",
    roles:["ê·¹ìƒ: ì™¸ì „ ì´ˆê¸°","ê·¹í•˜Â·ì†Œì›: ì™¸íšŒì „","ê²¬ê°‘í•˜: ë‚´íšŒì „","ê´€ì ˆ ì¤‘ì‹¬ ì•ˆì •í™”"],
    workouts:["íë°˜ í”„ë ˆìŠ¤","ì‚¬ì´ë“œ-ë¼ì‰ ì™¸íšŒì „","ë°´ë“œ ë‚´íšŒì „"] },
  { name:"ë‚´ì „ê·¼êµ°(ì¥/ë‹¨/ëŒ€ë‚´ì „ê·¼ ë“±)", tags:["ê³ ê´€ì ˆ ë‚´ì „"],
    where:"ì¹˜ê³¨Â·ì¢Œê³¨â†’ëŒ€í‡´ê³¨ í›„ì¸¡ì„ .",
    roles:["ê³ ê´€ì ˆ ë‚´ì „","êµ´ê³¡Â·ì™¸íšŒì „ ì¼ë¶€ ì„¬ìœ "],
    workouts:["ì–´ë•ì…˜ ë¨¸ì‹ ","ìŠ¬ë¼ì´ë“œ ë³´ë“œ ì‚¬ì´ë“œ ì»¬","ì¼€ì´ë¸” í¬ë¡œìŠ¤-ìŠ¤í… ì¸"] }
];
function makeCard({name,tags,where,roles,workouts}){
  const tagHtml = (tags||[]).map(t=>`<span class="tag">${t}</span>`).join("");
  const rolesHtml = (roles||[]).map(r=>`<li>${r}</li>`).join("");
  const workHtml = (workouts||[]).map(w=>`<li>${w}</li>`).join("");
  return `<div class="muscle-card">
    <h3>${name}</h3>
    <div>${tagHtml}</div>
    <div class="sec"><b>ìœ„ì¹˜</b><div class="small">${where}</div></div>
    <div class="sec"><b>ëŒ€í‘œ ì—­í• </b><ul class="list">${rolesHtml}</ul></div>
    <div class="sec"><b>ì¶”ì²œ ìš´ë™ë²•</b><ul class="list">${workHtml}</ul></div>
  </div>`;
}
document.getElementById('guideGrid').innerHTML = GUIDE.map(makeCard).join("");

const RECOVERY = [
  { name:"ìŠ¹ëª¨ê·¼(ìƒÂ·ì¤‘Â·í•˜ë¶€)",
    tags:["ëª©Â·ê²¬ê°‘ ì•ˆì •"],
    bw:["ìƒë¶€: ì¢ŒÂ·ìš° ì¸¡êµ´ ìŠ¤íŠ¸ë ˆì¹­ â€” í•œ ì†ìœ¼ë¡œ ë¨¸ë¦¬ ì‚´ì§ ë‹¹ê²¨ 20~30ì´ˆ Ã— 2~3ì„¸íŠ¸","ì¤‘ë¶€/í•˜ë¶€: ë²½ìŠ¬ë¼ì´ë“œ Y/T â€” 8~12íšŒ Ã— 2ì„¸íŠ¸, ê²¬ê°‘ í›„ì¸Â·í•˜ê°• ì˜ì‹"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ìƒë¶€ìŠ¹ëª¨ íŠ¸ë¦¬ê±°í¬ì¸íŠ¸ 20~40ì´ˆ ì••ë°•","í¼ë¡¤ëŸ¬: ë“± ìƒë¶€ë¥¼ ì„¸ë¡œë¡œ ë‘ê³  ìƒí•˜ë¡œ 8~12íšŒ"],
    care:["ìŠ¤ë§ˆíŠ¸í°Â·ë…¸íŠ¸ë¶ ì‹œ ì‹œì„  ìˆ˜í‰ ìœ ì§€, 30ë¶„ë§ˆë‹¤ ëª©Â·í‰ì¶” ê°€ë™","ê±°ë¶ëª© êµì •ì—” í•˜ë¶€ìŠ¹ëª¨+ì „ê±°ê·¼ í™œì„±í™” ë³‘í–‰"]
  },
  { name:"ê´‘ë°°ê·¼",
    tags:["ì–´ê¹¨ ë‚´ì „Â·ì‹ ì „"],
    bw:["ë„ì–´ì›¨ì´ ë¼íŠ¸ ìŠ¤íŠ¸ë ˆì¹˜ â€” ì—‰ë©ì´ ë’¤ë¡œ ë¹¼ë©° ì˜†êµ¬ë¦¬ ê¸¸ê²Œ 20~30ì´ˆ","ì°¨ì¼ë“œí¬ì¦ˆ ì¸¡ë©´ ë¦¬ì¹˜ â€” í˜¸í¡ê³¼ í•¨ê»˜ 30~40ì´ˆ"],
    tool:["í¼ë¡¤ëŸ¬: ì˜†êµ¬ë¦¬ ì•„ë˜ ëŒ€ê³  ì²œì²œíˆ 8~12íšŒ ì™•ë³µ","ë¼í¬ë¡œìŠ¤ë³¼: ê²¨ë“œë‘ì´ ì•ˆìª½ ë²½ ì••ë°• 20~30ì´ˆ"],
    care:["ë«í’€Â·í’€ì—… ì „ ì–´ê¹¨ í•˜ê°• ì„¸íŒ…, ê³¼ë„í•œ ë‚´íšŒì „/ì „ì¸ ìŠµê´€ êµì •"]
  },
  { name:"í–„ìŠ¤íŠ¸ë§",
    tags:["ë¬´ë¦ êµ´ê³¡ Â· ê³ ê´€ì ˆ ì‹ ì „"],
    bw:["ì¢Œì „êµ´(ì•‰ì•„ í–„ìŠ¤íŠ¸ë§) â€” í—ˆë¦¬ ì¤‘ë¦½, ë°˜ë™ ê¸ˆì§€ 20~30ì´ˆ","ìŠ¤íƒœí‹± ëŸ°ì§€ í›„ë°©ë‹¤ë¦¬ ì‹ ì „ ìœ ì§€ 20~30ì´ˆ"],
    tool:["í¼ë¡¤ëŸ¬: í—ˆë²…ì§€ ë’¤ 10~15íšŒ ì™•ë³µ Ã— 2ì„¸íŠ¸","ë§ˆì‚¬ì§€ë³¼: ì¢Œê³¨ê²°ì ˆ ì£¼ë³€ 20ì´ˆ ì ì••(ë¼ˆ ì§ì ‘ ì••ë°• ê¸ˆì§€)"],
    care:["ìš´ë™ í›„ ê°€ë²¼ìš´ ê±·ê¸°Â·ìì „ê±°ë¡œ í˜ˆë¥˜ íšŒë³µ","ê³¼ì‹ ì „ ë¬´ë¦ ì£¼ì˜, í™íŒì§€ íŒ¨í„´ í›ˆë ¨"]
  },
  { name:"ëŒ€í‡´ì‚¬ë‘ê·¼",
    tags:["ë¬´ë¦ ì‹ ì „"],
    bw:["ìŠ¤íƒ ë”© ì¿¼ë“œ ìŠ¤íŠ¸ë ˆì¹˜ â€” ë¬´ë¦ ëª¨ì•„ 20~30ì´ˆ","í”„ë¡ íŠ¸ ëŸ°ì§€ì—ì„œ ë’·ë‹¤ë¦¬ ì¿¼ë“œ ëŠ˜ë¦¬ê¸° 20ì´ˆ"],
    tool:["í¼ë¡¤ëŸ¬: í—ˆë²…ì§€ ì• 12~15íšŒ ì™•ë³µ","ë§ˆì‚¬ì§€ê±´: ê·¼ë³µë¶€ 30~60ì´ˆ(ìŠ¬ê°œê±´ ì§ì ‘ ìê·¹ ê¸ˆì§€)"],
    care:["ë¬´ë¦ í†µì¦ ì‹œ ê¹Šì€ êµ´ê³¡ í”¼í•˜ê³  ê³ ê´€ì ˆÂ·ë°œëª© ê°€ë™ì„± í™•ë³´"]
  },
  { name:"ë¹„ë³µê·¼",
    tags:["ë°œëª© ì €ì¸¡êµ´ê³¡"],
    bw:["ìŠ¤íƒ ë”© ì¹´í”„ ìŠ¤íŠ¸ë ˆì¹˜(ë¬´ë¦ í´ê³ ) 20~30ì´ˆ","ë²½ ì¹´í”„ ìŠ¤íŠ¸ë ˆì¹˜(ë¬´ë¦ êµ½í˜€ ê°€ìë¯¸ê·¼ í¬ì»¤ìŠ¤) 20ì´ˆ"],
    tool:["í¼ë¡¤ëŸ¬: ì¢…ì•„ë¦¬ 10~15íšŒ ì™•ë³µ","ë§ˆì‚¬ì§€ë³¼: ì¢…ì•„ë¦¬ ì¤‘ì•™ ë¼ì¸ 20ì´ˆ ì ì••"],
    care:["ë°œëª© ë°°ì¸¡êµ´ê³¡ ì œí•œ ì‹œ ìŠ¤ì¿¼íŠ¸ ê¹Šì´ ì œí•œë¨ â€” ì¼ìƒì—ì„œ ì¢…ì¢… ìŠ¤íŠ¸ë ˆì¹­"]
  },
  { name:"ì „ì™„ê·¼(êµ´ê·¼Â·ì‹ ê·¼)",
    tags:["ì†ëª© êµ´/ì‹ ì „"],
    bw:["íŒ” ë»—ê³  ì†ë°”ë‹¥ ìœ„ë¡œ ì –í˜€ ì „ì™„ êµ´ê·¼ ìŠ¤íŠ¸ë ˆì¹˜ 20ì´ˆ","ë°˜ëŒ€ë¡œ ì†ë“± ì¡ì•„ ì „ì™„ ì‹ ê·¼ ìŠ¤íŠ¸ë ˆì¹˜ 20ì´ˆ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ì „ì™„ ê·¼ë§‰ ë¡¤ë§ 30~40ì´ˆ","ë°”ì´ìŠ¤í‹°í¬(ìˆë‹¤ë©´): ê°€ë²¼ìš´ ì»´í”„ë ˆì…˜ í›„ ìŠ¤íŠ¸ë¦½"],
    care:["í‚¤ë³´ë“œÂ·ë§ˆìš°ìŠ¤ ë†’ì´ ì¡°ì ˆ, ì†ëª© ì¤‘ë¦½ ìœ ì§€ ìŠµê´€"]
  },
  { name:"ìƒì™„ì´ë‘ê·¼",
    tags:["íŒ”ê¿ˆì¹˜ êµ´ê³¡ Â· íšŒì™¸"],
    bw:["ë„ì–´ í”„ë ˆì„ ì¡ê³  ìƒì™„ ì „ë©´ ëŠ˜ì´ê¸° 20ì´ˆ","ë²½ì— ì†ë°”ë‹¥ ëŒ€ê³  íŒ” ì™¸íšŒì „í•˜ë©° ì „ì™„ ì „ë©´ ìŠ¤íŠ¸ë ˆì¹˜ 20ì´ˆ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ì´ë‘ ê·¼ë³µë¶€ 20ì´ˆ ì••ë°•","í¼ë¡¤ëŸ¬: ìƒì™„ ì „ë©´ 8~10íšŒ ì™•ë³µ"],
    care:["ê³¼ì‚¬ìš© ì‹œ íšŒì „ê·¼ê°œÂ·ì „ì™„ê³¼ ë°¸ëŸ°ìŠ¤ í›ˆë ¨ ë³‘í–‰"]
  },
  { name:"ìƒì™„ì‚¼ë‘ê·¼",
    tags:["íŒ”ê¿ˆì¹˜ ì‹ ì „"],
    bw:["ì˜¤ë²„í—¤ë“œ íŠ¸ë¼ì´ì…‰ìŠ¤ ìŠ¤íŠ¸ë ˆì¹˜ 20~30ì´ˆ","í¬ë¡œìŠ¤ë°”ë””ë¡œ íŒ”ê¿ˆì¹˜ ë‹¹ê²¨ í›„ë©´ ëŠ˜ë¦¬ê¸° 20ì´ˆ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ì‚¼ë‘ ì™¸ì¸¡ë‘Â·ì¥ë‘ ë¶€ìœ„ 20ì´ˆ ì ì••","í¼ë¡¤ëŸ¬: ìƒì™„ í›„ë©´ 8~12íšŒ"],
    care:["ë”¥ìŠ¤Â·ìŠ¤ì»¬í¬ëŸ¬ì…” í›„ ìŠ¤íŠ¸ë ˆì¹­ ë£¨í‹´í™”"]
  },
  { name:"ì‚¼ê°ê·¼(ì „Â·ì¤‘Â·í›„ë¶€)",
    tags:["ì–´ê¹¨ êµ´/ì™¸ì „/ì‹ ì „"],
    bw:["ë¬¸í‹€ ìŠ¤íŠ¸ë ˆì¹˜(ì „ë¶€) 20ì´ˆ","í¬ë¡œìŠ¤ë°”ë”” í›„ë©´ ìŠ¤íŠ¸ë ˆì¹˜(í›„ë¶€) 20ì´ˆ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: í›„ë¶€ ì‚¼ê°ê·¼Â·ê·¹í•˜ê·¼ ë¶€ìœ„ ë²½ ì••ë°• 20ì´ˆ","í¼ë¡¤ëŸ¬: ì¸¡ë©´ ì–´ê¹¨ ë¼ì¸ 8~10íšŒ"],
    care:["í”„ë ˆìŠ¤/ë ˆì´ì¦ˆ í›„ ê³¼ê¸´ì¥ ì™„í™”, íšŒì „ê·¼ê°œ ê°•í™” ë³‘í–‰"]
  },
  { name:"ë³µê·¼(ë³µì§ê·¼)",
    tags:["ëª¸í†µ êµ´ê³¡"],
    bw:["ì½”ë¸Œë¼ ìŠ¤íŠ¸ë ˆì¹˜(ìš”ë¶€ ë¬´ë¦¬ ì£¼ì˜) 15~20ì´ˆ","ìº£-ì¹´ìš°ë¡œ ê°€ë™ì„± í™•ë³´ 6~8íšŒ"],
    tool:["í¼ë¡¤ëŸ¬: ë³µì§ê·¼ì€ ì§ì ‘ ì••ë°• X, ëŒ€ì‹  ëŠ‘ê°„Â·ë³µì‚¬ê·¼ ì£¼ë³€ ê°€ë³ê²Œ","ë§ˆì‚¬ì§€ê±´: ë³µë¶€ ì§ì ‘ ì‚¬ìš© ë¹„ê¶Œì¥"],
    care:["ìš”í†µ ìˆìœ¼ë©´ ë²”ìœ„ ì¶•ì†Œ, í˜¸í¡Â·ë¸Œë ˆì´ì‹± í›ˆë ¨"]
  },
  { name:"ëŒ€ë‘”ê·¼",
    tags:["ê³ ê´€ì ˆ ì‹ ì „"],
    bw:["í”¼ì¡´ ìŠ¤íŠ¸ë ˆì¹˜(ëˆ„ì›Œ/ì•‰ì•„ì„œ ë³€í˜• ê°€ëŠ¥) 20~30ì´ˆ","ê¸€ë£¨íŠ¸ ìŠ¤íŠ¸ë© ìŠ¤íŠ¸ë ˆì¹˜ 20ì´ˆ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ë‘”ê·¼ ì™¸ì¸¡ íŠ¸ë¦¬ê±° 20ì´ˆ ì ì••","í¼ë¡¤ëŸ¬: ë‘”ê·¼ 10~15íšŒ ì™•ë³µ"],
    care:["ì˜¤ë˜ ì•‰ëŠ” ìŠµê´€ ì¤„ì´ê³ , í™ ìµìŠ¤í…ì…˜ í™œì„±í™” ë£¨í‹´"]
  },
  { name:"ì¤‘ë‘”ê·¼",
    tags:["ê³ ê´€ì ˆ ë²Œë¦¼"],
    bw:["ìŠ¤íƒ ë”© ì‚¬ì´ë“œ ë¦¬ì¹˜ í™ ìŠ¤íŠ¸ë ˆì¹˜ 20ì´ˆ","ì‚¬ì´ë“œ ëŸ°ì§€ ë³€í˜•ìœ¼ë¡œ ì™¸ì¸¡ì„  ëŠ˜ë¦¬ê¸° 10~12íšŒ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ëŒ€ì „ì ì£¼ë³€ ì¸¡ë©´ 15~20ì´ˆ ì••ë°•","í¼ë¡¤ëŸ¬: ITë°´ë“œ ê·¼ë§‰ì€ ê°„ì ‘(í†µì¦ ê³¼ë„ ì£¼ì˜)"],
    care:["ë³´í–‰Â·ìŠ¤ì¿¼íŠ¸ ì‹œ ë¬´ë¦ ì•ˆìª½ ë¶•ê´´(ë°œëª© ê³¼íšŒë‚´) êµì •"]
  },
  { name:"ì¥ìš”ê·¼",
    tags:["ê³ ê´€ì ˆ êµ´ê³¡"],
    bw:["ë‹ˆë§ í™ í”Œë ‰ì„œ ìŠ¤íŠ¸ë ˆì¹˜ â€” ê³¨ë°˜ í›„ë°©ê²½ì‚¬ ìœ ì§€ 20~30ì´ˆ","ë²½ ì¡ê³  ë¬´ë¦ ëŒì–´ì˜¬ë¦¬ê¸° ê°€ë™ 8~10íšŒ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ì¥ìš”ê·¼ì€ ê¹Šì–´ ê³¼ë„í•œ ì••ë°• ê¸ˆì§€(ë³µë¶€ ì¥ê¸° ë³´í˜¸)","í¼ë¡¤ëŸ¬: ëŒ€í‡´ì§ê·¼Â·TFL ì£¼ë³€ì„ ê°„ì ‘ì ìœ¼ë¡œ ì´ì™„"],
    care:["ì¥ì‹œê°„ ì¢Œì‹ í›„ ë°˜ë“œì‹œ ì‹ ì „ ìŠ¤íŠ¸ë ˆì¹­, ìš”ì¶” ê³¼ì „ë§Œ ì£¼ì˜"]
  },
  { name:"ì „ê±°ê·¼",
    tags:["ê²¬ê°‘ ì „ì¸/ìƒë°©íšŒì „"],
    bw:["ì›”ìŠ¬ë¼ì´ë“œ+ë¦¬ì¹˜ 8~10íšŒ","ì‚¬ë°© ë°©í–¥ ë¦¬ì¹˜ 6~8íšŒ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ê²¨ë“œë‘ì´ ì•Â·ì¸¡ë©´ ë¶€ë“œëŸ½ê²Œ 15ì´ˆ ì••ë°•","í¼ë¡¤ëŸ¬: í‰ê³½ ì¸¡ë©´ ê·¼ë§‰ ê°€ë³ê²Œ"],
    care:["í‘¸ì‹œì—… í”ŒëŸ¬ìŠ¤Â·ë¦¬ì¹˜ ë™ì‘ê³¼ í˜ì–´ë¡œ í™œì„±í™”"]
  },
  { name:"íšŒì „ê·¼ê°œ",
    tags:["ì–´ê¹¨ ì•ˆì •í™”"],
    bw:["ìˆ˜ê±´ ë¼ê³  ì™¸íšŒì „/ë‚´íšŒì „ ë“±ì²™ 8~12íšŒ","ìŠ¬ë¦¬í¼ ìŠ¤íŠ¸ë ˆì¹˜(ë‚´íšŒì „) 20ì´ˆ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ê·¹í•˜Â·ì†Œì›ê·¼ ë²½ ì••ë°• 15~20ì´ˆ","ë°´ë“œ: ê°€ë²¼ìš´ ë‚´/ì™¸íšŒì „ ê·¼ì§€êµ¬ë ¥ 12~15íšŒ"],
    care:["í†µì¦ê¶(ì•½ 60~120Â°) ë• ë²”ìœ„ ì¶•ì†Œ, ê²¬ê°‘ ë¦¬ë“¬ ì˜ì‹"]
  },
  { name:"ë‚´ì „ê·¼êµ°",
    tags:["ê³ ê´€ì ˆ ë‚´ì „"],
    bw:["í”„ë¡œê·¸ ìŠ¤íŠ¸ë ˆì¹˜ 20~30ì´ˆ","ì‚¬ì´ë“œ ëŸ°ì§€ í™€ë“œ 20ì´ˆ"],
    tool:["ë§ˆì‚¬ì§€ë³¼: ë‚´ì „ê·¼ ê·¼ë³µë¶€ 15~20ì´ˆ ì ì••","í¼ë¡¤ëŸ¬: ë‚´ì¸¡ ëŒ€í‡´ë¶€ 8~12íšŒ"],
    care:["ì‚¬ì´ë“œ ìŠ¤í…/ì–´ë¸Œë•ì…˜ìœ¼ë¡œ ê· í˜•, ê¸‰ê°€ë™ ì‹œ ê³¼ì‹ ì¥ ì£¼ì˜"]
  }
];

function recoveryCard(item){
  const tagHtml = (item.tags||[]).map(t=>`<span class="pill2">${t}</span>`).join("");
  const li = arr => (arr||[]).map(x=>`<li>${x}</li>`).join("");
  return `<div class="recovery-card">
    <h3>${item.name}</h3>
    <div class="pill-row">${tagHtml}</div>
    <div class="cols">
      <div class="box"><b>ë§¨ëª¸ ìŠ¤íŠ¸ë ˆì¹­</b><ul class="list">${li(item.bw)}</ul></div>
      <div class="box"><b>ë„êµ¬ ê¸°ë°˜(í¼ë¡¤ëŸ¬Â·ë§ˆì‚¬ì§€ë³¼)</b><ul class="list">${li(item.tool)}</ul></div>
    </div>
    <div class="sec"><b>íšŒë³µ & ì˜ˆë°©ë²•</b><ul class="list">${li(item.care)}</ul></div>
  </div>`;
}
document.getElementById('recoveryGrid').innerHTML = RECOVERY.map(recoveryCard).join("");

</script>
</body>
</html>
